<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Liste - https://workingtitle.pro">
    <title>Configure Harbor proxy cache for pulling images from Docker Hub | $ root@workingtitle.pro</title>
    <meta name="description" content="A minimal hugo theme focus on content">
    <meta property="og:title" content="Configure Harbor proxy cache for pulling images from Docker Hub" />
<meta property="og:description" content="Due to severe sanctions restrictions, I&rsquo;ve been having lots of trouble pulling images from Docker Hub. A great method of getting around this issue is to setup proxy cache on Harbor image registry. It can pull images from Docker Hub and cache them so for the next use, you&rsquo;ll end up pulling from your local repo instead of Docker Hub.
In order to do this, I needed to upgrade Harbor to the latest version." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://workingtitle.pro/posts/configure-proxy-cache-harbor/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-19T11:14:50+03:30" />
<meta property="article:modified_time" content="2023-08-19T11:14:50+03:30" />

    <meta itemprop="name" content="Configure Harbor proxy cache for pulling images from Docker Hub">
<meta itemprop="description" content="Due to severe sanctions restrictions, I&rsquo;ve been having lots of trouble pulling images from Docker Hub. A great method of getting around this issue is to setup proxy cache on Harbor image registry. It can pull images from Docker Hub and cache them so for the next use, you&rsquo;ll end up pulling from your local repo instead of Docker Hub.
In order to do this, I needed to upgrade Harbor to the latest version."><meta itemprop="datePublished" content="2023-08-19T11:14:50+03:30" />
<meta itemprop="dateModified" content="2023-08-19T11:14:50+03:30" />
<meta itemprop="wordCount" content="280">
<meta itemprop="keywords" content="" />
    
    <link rel="canonical" href="https://workingtitle.pro/posts/configure-proxy-cache-harbor/">
    <link rel="icon" href="https://workingtitle.pro/assets/favicon.ico">
    <link rel="dns-prefetch" href="https://www.google-analytics.com">
    <link href="https://www.google-analytics.com" rel="preconnect" crossorigin>
    <link rel="alternate" type="application/atom+xml" title="$ root@workingtitle.pro" href="https://workingtitle.pro/atom.xml" />
    <link rel="alternate" type="application/json" title="$ root@workingtitle.pro" href="https://workingtitle.pro/feed.json" />
    <link rel="shortcut icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNk+A8AAQUBAScY42YAAAAASUVORK5CYII=">
    
    <style>*,:after,:before{box-sizing:border-box;padding:0}body{font:1rem/1.5 '-apple-system',BlinkMacSystemFont,avenir next,avenir,helvetica,helvetica neue,ubuntu,roboto,noto,segoe ui,arial,sans-serif;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;padding:2rem;background:#f5f5f5;color:#000}.skip-link{position:absolute;top:-40px;left:0;background:#eee;z-index:100}.skip-link:focus{top:0}h1,h2,h3,h4,h5,strong,b{font-size:inherit;font-weight:600}header{line-height:2;padding-bottom:1.5rem}.link{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.time{font-variant-numeric:tabular-nums;white-space:nowrap}blockquote{border-left:5px solid #eee;padding-left:1rem;margin:0}a,a:visited{color:inherit}a:hover,a.heading-link{text-decoration:none}pre{padding:.5rem;overflow:auto;overflow-x:scroll;overflow-wrap:normal}code,pre{font-family:San Francisco Mono,Monaco,consolas,lucida console,dejavu sans mono,bitstream vera sans mono,monospace;font-size:normal;font-size:small;background:#eee}code{margin:.1rem;border:none}ul{list-style-type:square}ul,ol{padding-left:1.2rem}.list{line-height:2;list-style-type:none;padding-left:0}.list li{padding-bottom:.1rem}.meta{color:#777}.content{max-width:70ch;margin:0 auto}header{line-height:2;display:flex;justify-content:space-between;padding-bottom:1rem}header a{text-decoration:none}header ul{list-style-type:none;padding:0}header li,header a{display:inline}h2.post{padding-top:.5rem}header ul a:first-child{padding-left:1rem}.nav{height:1px;background:#000;content:'';max-width:10%}.list li{display:flex;align-items:baseline}.list li time{flex:initial}.hr-list{margin-top:0;margin-bottom:0;margin-right:.5rem;margin-left:.5rem;height:1px;border:0;flex:1 0 1rem}.m,hr{border:0;margin:3rem 0}img{max-width:100%;height:auto}.post-date{margin:5% 0}.index-date{color:#9a9a9a}.animate-blink{animation:opacity 1s infinite;opacity:1}@keyframes opacity{0%{opacity:1}50%{opacity:.5}100%{opacity:0}}.tags{display:flex;justify-content:space-between}.tags ul{padding:0;margin:0}.tags li{display:inline}.avatar{height:120px;width:120px;position:relative;margin:-10px 0 0 15px;float:right;border-radius:50%}</style>
  
    
  
  
  <script type="application/ld+json">
  {
      "@context": "http://schema.org",
      "@type": "BlogPosting",
      "articleSection": "posts",
      "name": "Configure Harbor proxy cache for pulling images from Docker Hub",
      "headline": "Configure Harbor proxy cache for pulling images from Docker Hub",
      "alternativeHeadline": "",
      "description": "Due to severe sanctions restrictions, I\u0026rsquo;ve been having lots of trouble pulling images from Docker Hub. A great method of getting around this issue is to setup proxy cache on Harbor image registry. It can pull images from Docker Hub and cache them so for the next use, you\u0026rsquo;ll end up pulling from your local repo instead of Docker Hub.\nIn order to do this, I needed to upgrade Harbor to the latest version.",
      "inLanguage": "en-us",
      "isFamilyFriendly": "true",
      "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "https:\/\/workingtitle.pro\/posts\/configure-proxy-cache-harbor\/"
      },
      "author" : {
          "@type": "Person",
          "name": ""
      },
      "creator" : {
          "@type": "Person",
          "name": ""
      },
      "accountablePerson" : {
          "@type": "Person",
          "name": ""
      },
      "copyrightHolder" : "$ root@workingtitle.pro",
      "copyrightYear" : "2023",
      "dateCreated": "2023-08-19T11:14:50.00Z",
      "datePublished": "2023-08-19T11:14:50.00Z",
      "dateModified": "2023-08-19T11:14:50.00Z",
      "publisher":{
          "@type":"Organization",
          "name": "$ root@workingtitle.pro",
          "url": "https://workingtitle.pro",
          "logo": {
              "@type": "ImageObject",
              "url": "https:\/\/workingtitle.pro\/assets\/favicon.ico",
              "width":"32",
              "height":"32"
          }
      },
      "image": "https://workingtitle.pro/assets/favicon.ico",
      "url" : "https:\/\/workingtitle.pro\/posts\/configure-proxy-cache-harbor\/",
      "wordCount" : "280",
      "genre" : [ ],
      "keywords" : [ ]
  }
  </script>
  
  
  </head>
<body>
  <a class="skip-link" href="#main">Skip to main</a>
  <main id="main">
  <div class="content">
    <header>
<p style="padding: 0;margin: 0;">
  <a href="/">
    <b>$ root@workingtitle.pro</b>
    <span class="text-stone-500 animate-blink">â–®</span>
  </a>
</p>
<ul style="padding: 0;margin: 0;">
  
  
  <li class="">
    <a href="/posts/"><span>Post</span></a>
    
  <li class="">
    <a href="/about/"><span>About</span></a>
    
  </li>
</ul>
</header>
<hr class="hr-list" style="padding: 0;margin: 0;">
    <section>
      <h2 class="post">Configure Harbor proxy cache for pulling images from Docker Hub</h2>
      <p>Due to severe sanctions restrictions, I&rsquo;ve been having lots of trouble pulling images from Docker Hub. A great method of getting around this issue is to setup proxy cache on Harbor image registry. It can pull images from Docker Hub and cache them so for the next use, you&rsquo;ll end up pulling from your local repo instead of Docker Hub.</p>
<p>In order to do this, I needed to upgrade Harbor to the latest version. You can do that by following the <a href="https://goharbor.io/docs/2.8.0/administration/upgrade/">official docs</a>.</p>
<p>After you&rsquo;ve done that, you can follow these steps:</p>
<ol>
<li>
<p>On the Harbor dashboard navigate to <strong>Administration &gt; Registries &gt; New Endpoint</strong></p>
</li>
<li>
<p>Select <strong>Docker Hub</strong> as the provider, give it a name and then test your connection to Docker Hub.
<img
  src="https://workingtitle.pro/images/new-endpoint-harbor.png"
  alt="new-endpoint-harbor"
  loading="lazy"
  decoding="async"
  class="full-width"
/>

</p>
</li>
<li>
<p>Click on <strong>Test connection</strong> to check your connection. In my case, I had to configure an HTTP proxy in <code>harbor.yaml</code> file since my server does not have direct access to internet. <em>(Side note to all my Iranian readers: Use &ldquo;shecan&rdquo; as your DNS)</em></p>
</li>
<li>
<p>After saving, you should have a working endpoint like this:
<img
  src="https://workingtitle.pro/images/endpoint-configured-harbor.png"
  alt="endpoint-configured-harbor"
  loading="lazy"
  decoding="async"
  class="full-width"
/>

</p>
</li>
<li>
<p>Navigate to <strong>Projects &gt; New Project</strong> and create a project named <code>proxy_cache</code>. Make sure to enable the proxy cache option and point it to the registry you just created. As so:</p>
</li>
</ol>
<p><img
  src="https://workingtitle.pro/images/proxy-cache-project-harbor.png"
  alt="proxy-cache-project-harbor"
  loading="lazy"
  decoding="async"
  class="full-width"
/>

</p>
<p>And we&rsquo;re done!</p>
<p>Now when you want to pull an image, you should do so in this format:</p>
<pre tabindex="0"><code>docker pull yourRepoAddress.com/proxy_cache/&lt;image_name&gt;:&lt;image_tag&gt;
</code></pre><p>In my example, it looks like this:</p>
<pre tabindex="0"><code>docker pull reg.zcore.local/proxy_cache/nginx:latest
</code></pre><p>If the image is already present, it will download it from the cache. Otherwise, it will pull it from Docker Hub. It will also always check and if there is a new version available on Docker Hub, it will try to download that.</p>

      
      <div class="post-date">
        <span class="g time">August 19, 2023 </span> &#8729;
         
      </div>
      
    </section>
    
    <div id="comments">
      <script src="https://utteranc.es/client.js"
    repo=ali-foroughi/workingtitle.pro
    issue-term="pathname"
    theme=github-light
    crossorigin="anonymous"
    async>
</script>

    </div>
    
  </div>
</main>
</body>
</html>
